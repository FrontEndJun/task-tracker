(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{24:function(e,a,t){e.exports=t(48)},45:function(e,a,t){},48:function(e,a,t){"use strict";t.r(a);var n=t(0),c=t.n(n),r=t(20),l=t.n(r),s=t(4),i=t(10),m=t(12),o=t(3),u=t.n(o),d=t(8),p=t(7),E=t(1),v=function(){var e=Object(n.useState)(!1),a=Object(E.a)(e,2),t=a[0],c=a[1],r=Object(n.useState)({msg:"",isErrors:!1}),l=Object(E.a)(r,2),s=l[0],i=l[1];return{loading:t,req:Object(n.useCallback)(function(){var e=Object(p.a)(u.a.mark((function e(a){var t,n,r,l,s,m=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.length>1&&void 0!==m[1]?m[1]:"GET",n=m.length>2&&void 0!==m[2]?m[2]:null,r=m.length>3&&void 0!==m[3]?m[3]:{},c(!0),e.prev=4,n&&(n=JSON.stringify(n)),e.next=8,fetch("https://react-tracker-task.herokuapp.com".concat(a),{headers:r,method:t,body:n});case 8:return l=e.sent,e.next=11,l.json();case 11:if(s=e.sent,l.ok){e.next=16;break}return i({msg:s.msg,isError:!0}),c(!1),e.abrupt("return",!1);case 16:return c(!1),e.abrupt("return",s);case 20:e.prev=20,e.t0=e.catch(4),c(!1),i({msg:e.t0.message,isError:!0});case 24:case"end":return e.stop()}}),e,null,[[4,20]])})));return function(a){return e.apply(this,arguments)}}(),[]),errors:s,clearErrors:Object(n.useCallback)((function(){return i(null)}),[])}},f=Object(n.createContext)({token:null,admin:!1,userId:null,isAuth:!1}),b=function(){var e=v(),a=e.req,t=e.loading,r=e.errors,l=Object(n.useState)({username:"",password:""}),s=Object(E.a)(l,2),i=s[0],o=s[1],b=Object(n.useContext)(f),g=function(){var e=Object(p.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,a("/auth/login","POST",Object(d.a)({},i),{"Content-Type":"application/json"});case 3:(n=e.sent)&&b.login(n.tkn,n.id,n.isAdmin);case 5:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),N=function(e){o(Object(d.a)({},i,Object(m.a)({},e.target.name,e.target.value)))};return c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col s6 offset-s3"},c.a.createElement("h2",{className:"offset-s4 col"},"LogIn"),c.a.createElement("form",{onSubmit:g},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"input-field col s6"},c.a.createElement("input",{id:"username",type:"text",name:"username",className:"validate",onChange:N}),c.a.createElement("label",{htmlFor:"first_name",className:"active"},"Username")),c.a.createElement("div",{className:"input-field col s6"},c.a.createElement("input",{id:"password",type:"password",name:"password",onChange:N}),c.a.createElement("label",{htmlFor:"last_name",className:"active "},"Password")),c.a.createElement("button",{type:"submit",className:"waves-effect waves-light btn col s4 offset-s4",disabled:t&&!r.isErrors},"Sign In")))),r&&!r.isErrors&&c.a.createElement("p",{className:"col s12 red-text"},r.msg))},g=function(e){var a=e.currentPage,t=1==a,n=a==e.pages;return c.a.createElement("ul",{className:"pagination"},c.a.createElement("li",{key:"1",className:"waves-effect ".concat(t?"disabled":"")},c.a.createElement(s.b,{to:"/tasks/".concat(a-1),className:t?"disabled":""},c.a.createElement("i",{className:"material-icons"},"chevron_left"))),c.a.createElement("li",{key:"2",className:"active"},c.a.createElement("a",{href:"#!"},a)),c.a.createElement("li",{key:"3",className:"waves-effect ".concat(n?"disabled":"")},c.a.createElement(s.b,{to:"/tasks/".concat(a+1),className:n?"disabled":""},c.a.createElement("i",{className:"material-icons"},"chevron_right"))))},N={username:"",email:"",text:""},h=function(){var e=Object(n.useState)(N),a=Object(E.a)(e,2),t=a[0],r=a[1],l=v(),s=l.req,i=(l.errors,function(e){r(Object(d.a)({},t,Object(m.a)({},e.target.name,e.target.value)))}),o=function(){var e=Object(p.a)(u.a.mark((function e(a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,s("/tasks/create","POST",Object(d.a)({},t),{"Content-Type":"application/json"});case 3:e.sent,r(N);case 5:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();return c.a.createElement("form",{onSubmit:o,className:"row valign-wrapper"},c.a.createElement("div",{className:"col s2"},c.a.createElement("input",{id:"username",placeholder:"Username",type:"text",className:"validate",name:"username",value:t.username,onChange:i})),c.a.createElement("div",{className:"col s3"},c.a.createElement("input",{id:"email",placeholder:"Email",type:"email",className:"validate",name:"email",value:t.email,onChange:i})),c.a.createElement("div",{className:"col s6"},c.a.createElement("textarea",{id:"text",placeholder:"Task Text",className:"materialize-textarea",name:"text",value:t.text,onChange:i})),c.a.createElement("div",{className:"col s1"},c.a.createElement("button",{type:"submit",className:"waves-effect waves-light btn"},"Add Task")))},j=function(){var e=Object(n.useRef)(null),a=function(){var e=Object(n.useState)(""),a=Object(E.a)(e,2),t=a[0],c=a[1],r=Object(n.useState)(""),l=Object(E.a)(r,2),s=l[0],m=l[1],o=Object(i.g)(),u=Object(i.i)().page,d=Object(n.useCallback)((function(){o.push("/tasks/".concat(u,"?filter=").concat(t,"&dir=").concat(s))}),[s,t,u]);return Object(n.useEffect)((function(){d()}),[d]),{filterName:t,filterDir:s,page:u,changeDir:function(){m(""===s?"DESC":"")},changeFilter:function(e){c(e)},filter:d}}(),t=a.filterDir,r=a.changeDir,l=a.changeFilter;return Object(n.useEffect)((function(){window.M.FormSelect.init(e.current)}),[]),c.a.createElement("div",{className:"row valign-wrapper"},c.a.createElement("div",{className:"input-field col s6 offset-s3"},c.a.createElement("select",{ref:e,onChange:function(e){return l(e.target.value)},value:"default"},c.a.createElement("option",{value:"default",disabled:!0},"Sort By:"),c.a.createElement("option",{value:"email"},"Email"),c.a.createElement("option",{value:"username"},"Username"),c.a.createElement("option",{value:"completed"},"Status")),c.a.createElement("label",null)),c.a.createElement("button",{className:"btn-floating btn-large waves-effect waves-light teal lighten-2 ".concat(t&&"rotate180"),onClick:function(e){return r()}},c.a.createElement("i",{className:"material-icons dp48"},"arrow_upward")))},O=t(23),k=t.n(O),w=function(){return c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"preloader-wrapper big active col offset-s5"},c.a.createElement("div",{className:"spinner-layer spinner-blue"},c.a.createElement("div",{className:"circle-clipper left"},c.a.createElement("div",{className:"circle"})),c.a.createElement("div",{className:"gap-patch"},c.a.createElement("div",{className:"circle"})),c.a.createElement("div",{className:"circle-clipper right"},c.a.createElement("div",{className:"circle"}))),c.a.createElement("div",{className:"spinner-layer spinner-red"},c.a.createElement("div",{className:"circle-clipper left"},c.a.createElement("div",{className:"circle"})),c.a.createElement("div",{className:"gap-patch"},c.a.createElement("div",{className:"circle"})),c.a.createElement("div",{className:"circle-clipper right"},c.a.createElement("div",{className:"circle"}))),c.a.createElement("div",{className:"spinner-layer spinner-yellow"},c.a.createElement("div",{className:"circle-clipper left"},c.a.createElement("div",{className:"circle"})),c.a.createElement("div",{className:"gap-patch"},c.a.createElement("div",{className:"circle"})),c.a.createElement("div",{className:"circle-clipper right"},c.a.createElement("div",{className:"circle"}))),c.a.createElement("div",{className:"spinner-layer spinner-green"},c.a.createElement("div",{className:"circle-clipper left"},c.a.createElement("div",{className:"circle"})),c.a.createElement("div",{className:"gap-patch"},c.a.createElement("div",{className:"circle"})),c.a.createElement("div",{className:"circle-clipper right"},c.a.createElement("div",{className:"circle"})))))},x=function(e){var a=e.id,t=e.email,r=e.text,l=e.completed,s=e.username,i=e.edited,m=Object(n.useState)(!1),o=Object(E.a)(m,2),b=o[0],g=o[1],N=Object(n.useState)({text:r,completed:l}),h=Object(E.a)(N,2),j=h[0],O=h[1],k=Object(n.useContext)(f),w=k.admin,x=k.token,y=v().req,S=function(){var e=Object(p.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!1),e.next=3,y("/tasks/".concat(a),"PUT",Object(d.a)({},j),{"Content-Type":"application/json",Authorization:"Bearer ".concat(x)});case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();return c.a.createElement("tr",{className:"row valign-wrapper"},c.a.createElement("td",{className:"col s3"},t),c.a.createElement("td",{className:"col s2"},s),c.a.createElement("td",{className:"col s4"},c.a.createElement("textarea",{id:"id",name:"text",disabled:!w,className:"materialize-textarea",value:j.text,onChange:function(e){O(Object(d.a)({},j,{text:e.target.value})),g(!0)}})),c.a.createElement("td",{className:"col s1 valign-wrapper"},c.a.createElement("label",{className:""},c.a.createElement("input",{type:"checkbox",name:"completed",className:"filled-in",defaultChecked:j.completed,disabled:!w,onChange:function(e){O(Object(d.a)({},j,{completed:!l})),g(!0)}}),c.a.createElement("span",null," "))),c.a.createElement("td",{className:"col s2"},c.a.createElement("button",{className:"btn waves-effect waves-light  ".concat(b?"":"none"),type:"submit",name:"action",onClick:S},"Save",c.a.createElement("i",{className:"material-icons dp48"},"autorenew")),i?"\u041e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u043e\u043c":""))},y=function(e){var a=e.tasks,t=e.loading;return c.a.createElement("table",null,c.a.createElement("thead",null,c.a.createElement("tr",{className:"row"},c.a.createElement("th",{className:"col s3"},"Email"),c.a.createElement("th",{className:"col s2"},"Username"),c.a.createElement("th",{className:"col s4"},"Task Text"),c.a.createElement("th",{className:"col s2"},"Completed"),c.a.createElement("th",{className:"col s1"}))),t?c.a.createElement(w,null):a&&c.a.createElement("tbody",null,a.map((function(e){return c.a.createElement(x,Object.assign({key:e.id},e))}))))},S=function(){var e=Object(n.useState)([]),a=Object(E.a)(e,2),t=a[0],r=a[1],l=Object(n.useState)(1),s=Object(E.a)(l,2),m=s[0],o=s[1],d=v(),f=d.req,b=d.loading,N=Object(i.i)().page,O=Object(i.h)(),w=k.a.parse(O.search);return Object(n.useEffect)((function(){(function(){var e=Object(p.a)(u.a.mark((function e(){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f("/tasks/".concat(N,"?filter=").concat(w.filter,"&dir=").concat(w.dir));case 2:a=e.sent,r(a.tasks),o(Math.ceil(a.all/3));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[N,f,O]),console.count("render"),c.a.createElement("div",{className:"container"},c.a.createElement(h,null),c.a.createElement(j,null),c.a.createElement(y,{tasks:t,loading:b}),c.a.createElement(g,{currentPage:parseInt(N,10),pages:m}))},C=function(){return c.a.createElement("div",{className:"container"},c.a.createElement("h5",null,"Developed By Kondrev Georgy ","<george.kondrev@yandex.ru>"),c.a.createElement("p",null," Special for Deltaplan"),c.a.createElement("p",null," Provided By React - Node.js - Express - MySql "))},T=function(){var e=Object(n.useContext)(f);return c.a.createElement("nav",null,c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"nav-wrapper"},c.a.createElement(s.b,{to:"/",className:"brand-logo"},"Task Tracker"),c.a.createElement("ul",{id:"nav-mobile",className:"right hide-on-med-and-down"},c.a.createElement("li",null,c.a.createElement(s.c,{to:"/tasks/1"},"Tasks")),c.a.createElement("li",null,c.a.createElement(s.c,{to:"/about"},"About")),c.a.createElement("li",null,e.isAuth?c.a.createElement("a",{onClick:function(){e.logout()}},"Log out"):c.a.createElement(s.c,{to:"/auth"},"Log In"))))))};var I=function(){var e=function(){var e=Object(n.useState)(null),a=Object(E.a)(e,2),t=a[0],c=a[1],r=Object(n.useState)(null),l=Object(E.a)(r,2),s=l[0],i=l[1],m=Object(n.useState)(null),o=Object(E.a)(m,2),u=o[0],d=o[1],p=Object(n.useCallback)((function(e,a,t){c(e),i(a),d(t),localStorage.setItem("userdata",JSON.stringify({token:e,admin:t,userId:a}))}),[]),v=Object(n.useCallback)((function(){c(null),i(null),d(null),localStorage.removeItem("userdata")}),[]);return Object(n.useEffect)((function(){var e=JSON.parse(localStorage.getItem("userdata"));e&&e.token&&p(e.token,e.userId,e.admin)}),[p]),{login:p,logout:v,token:t,admin:u,userId:s}}(),a=e.token,t=e.userId,r=e.admin,l=e.login,m=e.logout,o=!!a;return c.a.createElement(f.Provider,{value:{token:a,admin:r,userId:t,isAuth:o,login:l,logout:m}},c.a.createElement(s.a,{basename:"/task-tracker/"},c.a.createElement(T,null),c.a.createElement(i.d,null,c.a.createElement(i.b,{exact:!0,path:"/tasks/:page"},c.a.createElement(S,null)),c.a.createElement(i.b,{path:"/about"},c.a.createElement(C,null)),!o&&c.a.createElement(i.b,{exact:!0,path:"/auth"},c.a.createElement(b,null)),c.a.createElement(i.a,{to:"/tasks/1"}))))};t(45),t(46),t(47);l.a.render(c.a.createElement(I,null),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.91791227.chunk.js.map